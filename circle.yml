machine:
   services:
      - docker
   environment: 
      NODE_ENV: staging

# Replace the Dockerfile with a staging version 
checkout:
   post: 
      - mv Dockerfile.staging Dockerfile

dependencies:
   override:
      - npm install
      - cd client && bower install && npm install && npm install -g grunt grunt-cli && cd ..
      - docker build -t instanews .
test:
   override:
     - cd client && grunt karma && cd ..
     - docker run -t instanews
       #- docker run -t -p 3000:3000 instanews
#      - npm test

#deployment:
#   staging:
      # Run for all branches that start with 'staging'
#     branch: /staging*/
#     commands:
#        - ./hello_world.sh
